\chapter{Schnittstelle}

In diesem Kapitel wird die Schnittstelle des \textbf{Spiegel AI} Projekts beschrieben. Wir erläutern die verschiedenen Schnittstellen, die verwendet werden, sowie deren Implementierung und Nutzung.

\section{Überblick}
Geben Sie einen Überblick über die verwendeten Schnittstellen.

\section{Implementierung}
Beschreiben Sie die Implementierung der Schnittstellen.

\section{Nutzung}
Erläutern Sie, wie die Schnittstellen genutzt werden.

\subsection{Dynamische Widget Anordnung}
Erarbeitet von: Marcel Wagner \\ \\
Die Entwicklung eines Smart Mirrors mit dynamisch anpassbarer Display Anordnung stellt eine technische Herausforderung dar. Das Ziel dieses Bereiches war es, eine benutzerfreundliche und flexible Oberfläche zu schaffen, die sich den individuellen Präferenzen der Benutzer anpasst. Dieser Abschnitt beschreibt ausführlich die Methodik der Implementierung der dynamischen Display Anordnung sowie die dabei aufgetretenen Probleme und deren Lösungen. \\ \\
Ein essenzieller Bestandteil des Systems war die kontinuierliche Überwachung der 'profiles.json' Datei. Diese Datei wird von der Gesichtserkennung erstellt. Auf diesen Bereich wurde im vorherigen Kapitel bereits eingegangen. Hierzu wurde ein periodischer Abrufmechanismus implementiert, der alle 200 Millisekunden die Datei abfragt. Bei jeder Abfrage wurde der aktuelle Inhalt der Datei mit dem vorherigen Zustand verglichen, um Änderungen zu erkennen. Diese Methode stellte sicher, dass Anpassungen in den Benutzerprofilen zeitnah detektiert und umgesetzt wurden. \\ \\
Aus dieser Datei wird beginnend nach dem aktuellen ausgewählten Profil gesucht. Zur Identifikation des aktuell ausgewählten Profils wurde eine spezielle Funktion entwickelt. Diese Funktion durchsuchte die Liste der Profile nach dem als ausgewählt markierten Profil und gibt diese zurück. Ist kein Profil ausgewählt, wird null zurückgegeben, was die Anwendung des Standardzustands bedeutet. Die Fähigkeit, das aktive Profil zu identifizieren, war entscheidend für die Anpassung der Display Anordnung und stellte sicher, dass die Benutzereinstellungen korrekt umgesetzt wurden. \\ \\
Als nächster Schritt war ein weiterer zentraler Aspekt der Implementierung eine Funktion für die Ermittlung des aktuellen Zustands der Widgets. Hierbei wird das vorher ausgelesene Profil genutzt um hierfür den Zustand und Positionierung der Widgets auszulesen. Diese flexible Handhabung ermöglichte es, die Anzeige dynamisch an die individuellen Präferenzen der Benutzer anzupassen. \\ \\
Abschließend mussten noch auf Basis dieser Daten eine Dynamische Anpassung der HTML Seite vorgenommen werden.  Basierend auf dem aktuellen Zustand der Widgets wurden die entsprechenden HTML Elemente ein- oder ausgeblendet und in der gewünschten Reihenfolge angeordnet. Diese Anpassungen wurden durch die Funktion 'updateState' gesteuert, die die Widgets gemäß den Benutzereinstellungen neu positionierte. Die Funktion arbeitete folgendermaßen: Zunächst wird der Container, der die Widgets enthielt, geleert. Anschließend werden die Widgets gemäß der im Profil definierten Reihenfolge wieder hinzugefügt. Dabei wird auch die Sichtbarkeit jedes Widgets entsprechend dem enabled Status beachtet. Widgets, die nicht aktiviert waren, werden ausgeblendet, während aktivierte Widgets sichtbar blieben. Diese dynamische Anpassung ermöglichte es, die Widgets je nach Benutzerprofil in der gewünschten Anordnung und Sichtbarkeit darzustellen.

\subsection*{Aufgetretene Probleme und deren Lösung}
\textbf{Cache Verwaltung:} Das am häufigsten aufgetretene Problem war das der Cache Verwaltung des Browsers. Dies stellte eine besondere Herausforderung dar, da durch die regelmäßigen Anfragen an die 'profiles.json' Datei oft veralteter Inhalt aus dem Cache verwendet wurde, anstatt die neuesten Daten abzurufen. Dieses Problem wurde durch gezielte Deaktivierung des Caches für die betreffenden Anfragen gelöst. Der HTTP Header Cache Control wurde entsprechend konfiguriert, um sicherzustellen, dass die Anfragen stets frische Daten zurückliefert. Dies gewährleistete, dass immer die aktuellste Version der profiles.json Datei abgerufen und verarbeitet wurde, was eine zuverlässige Aktualisierung der Anzeige ermöglicht. \\ \\
\noindent
\textbf{CORS Beschränkung:} Ein weiteres Problem, welches während der Implementierung aufgetreten ist, war im Zusammenhang mit der Same Origin Policy des Browsers. Diese Sicherheitsrichtlinie verhinderte den Abruf der profiles.json Datei von einem anderen Ursprung, was die Aktualisierung der Profile erschwerte. Um dieses Problem zu umgehen, wurde ein lokaler Server mit Python erstellt, der die Datei ausliefert. Dieser Server ermöglichte es, die Datei lokal zu hosten und somit die CORS Beschränkungen (Cross Origin Resource Sharing) zu umgehen. Durch den Zugriff auf diesen lokalen Server konnte die Datei problemlos und sicher abgerufen werden, was die zuverlässige Aktualisierung der Profile gewährleistet.
\\ \\
\\noindent
\textbf{Script ausführung in der Update State:} Ein weiteres Hinderniss bei der Implementierung der Dynamischen Anordnung war in der updateState

